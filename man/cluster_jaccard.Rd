% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pathway-clustering-functions.R
\name{cluster_jaccard}
\alias{cluster_jaccard}
\title{Perform Jaccard clustering of pathways and output results to an Excel workbook.}
\usage{
cluster_jaccard(contrast, contrast_color, wb, pathway_table)
}
\arguments{
\item{contrast}{A character string specifying the contrast (e.g., \code{"WT vs. GFP"}) used to subset the pathways.}

\item{contrast_color}{A character string representing the tab color (as a hex code, e.g., \code{"#FAE1DD"}) for the worksheet corresponding to this contrast.}

\item{wb}{A workbook object created by \code{openxlsx::createWorkbook()} where the clustered results will be added.}

\item{pathway_table}{A \code{data.table} containing the pathways to be clustered. This table must include the following columns:
\code{Contrast}, \code{MEMBERS_SYMBOLIZED}, \code{NAME}, \code{Comparison}, \code{Regulation}, \code{SIZE}, \code{ES}, \code{NES},
\code{NOM.p.val}, \code{FDR.q.val}, \code{FWER.p.val}, \code{CONTRIBUTOR}, \code{SUB_CATEGORY_CODE}, \code{EXACT_SOURCE},
\code{DESCRIPTION_BRIEF}, and \code{MEMBERS_EZID}.}
}
\value{
A \code{data.table} containing the pathways annotated with cluster information.
}
\description{
This function performs hierarchical clustering on gene sets (pathways) based on the Jaccard similarity of their gene members.
It subsets pathways from the supplied \code{pathway_table} using the specified contrast, computes the similarity matrix,
performs hierarchical clustering, and generates a dendrogram saved as a PDF. The function then annotates the pathways with cluster information
(using \code{annotate_clusters()}) and writes the result to a specified worksheet in an \code{openxlsx} workbook via \code{add_table_to_workbook()}.
}
\details{
The dendrogram is saved as a PDF in the \code{"Results/GSEA_preranked/pathways"} directory relative to the project root.
}
\seealso{
\code{\link{compute_jaccard_similarity}}, \code{\link{annotate_clusters}}, \code{\link{add_table_to_workbook}}
}
